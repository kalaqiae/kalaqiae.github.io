{{ define "title" }}QR 码生成器 - {{ .Site.Title }}{{ end }}

{{ define "main" }}
<div class="tool-container">
  <div class="card-content">
    <h1 class="text-3xl font-bold mb-6 text-gray-800 flex items-center">
      <svg class="w-6 h-6 mr-3 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"
        xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zm10 0a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z">
        </path>
      </svg>
      QR 码生成器
    </h1>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- 输入区 -->
      <div class="space-y-6">
        <div>
          <label for="qrInput" class="block text-lg font-semibold mb-2 text-gray-700">输入内容：</label>
          <textarea id="qrInput" rows="5" placeholder="请输入文字或链接" class="input-box"></textarea>
          <p class="text-sm text-gray-500 mt-1">字符数：<span id="charCount">0</span></p>
        </div>

        <button id="generateBtn" class="tool-button w-full bg-blue-600 text-white hover:bg-blue-700">
          ⚙️ 生成 QR 码
        </button>
      </div>

      <!-- 显示区 -->
      <div
        class="flex flex-col items-center justify-center p-4 bg-gray-50 border border-gray-200 rounded-xl shadow-inner min-h-[300px]">
        <label class="text-lg font-semibold mb-4 text-gray-700">生成结果：</label>
        <div id="qrcode" class="bg-white p-2 rounded shadow-lg"></div>
        <p id="qrStatus" class="mt-4 text-gray-500 text-sm">请输入内容并点击“生成 QR 码”</p>
      </div>
    </div>
  </div>
</div>

<style>
  .tool-container {
    max-width: 960px;
    margin: 40px auto;
    padding: 20px;
  }

  .card-content {
    background: var(--card-background-base, #fff);
    border-radius: 10px;
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
    padding: 2rem;
  }

  .input-box {
    width: 100%;
    border: 2px solid #E0E0E0;
    border-radius: 6px;
    padding: 0.75rem;
    font-size: 0.95rem;
    outline: none;
    transition: border-color 0.2s;
  }

  .input-box:focus {
    border-color: #1E88E5;
    box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.2);
  }

  .tool-button {
    padding: 0.75rem;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    border: none;
    transition: all 0.2s;
  }

  .tool-button:active {
    transform: scale(0.98);
  }
</style>

<!-- ✅ 使用 qrcodejs 生成 QR -->
<script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>

<script>
  const qrInput = document.getElementById("qrInput");
  const charCountSpan = document.getElementById("charCount");
  const qrcodeContainer = document.getElementById("qrcode");
  const qrStatus = document.getElementById("qrStatus");
  const generateBtn = document.getElementById("generateBtn");
  let qr;

  // 监听输入字符数
  qrInput.addEventListener("input", () => {
    charCountSpan.textContent = qrInput.value.trim().length;
  });

  // 点击生成
  generateBtn.addEventListener("click", () => {
    const text = qrInput.value.trim();
    charCountSpan.textContent = text.length;

    if (!text) {
      qrcodeContainer.innerHTML = "";
      qrStatus.textContent = "请输入内容后再点击生成。";
      return;
    }

    // 清空并生成新的 QR
    qrcodeContainer.innerHTML = "";
    qr = new QRCode(qrcodeContainer, {
      text: text,
      width: 256,
      height: 256,
      colorDark: "#000000",
      colorLight: "#ffffff",
      correctLevel: QRCode.CorrectLevel.M,
    });

    qrStatus.textContent = "QR 码已生成 ✔";
  });

  // 页面加载默认状态
  document.addEventListener("DOMContentLoaded", () => {
    qrStatus.textContent = "请输入内容并点击“生成 QR 码”";
  });
</script>
{{ end }}